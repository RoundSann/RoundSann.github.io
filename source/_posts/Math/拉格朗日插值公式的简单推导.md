---
title: 拉格朗日插值公式的简单推导
date: 2023-06-22 18:29:29
tags: [高等代数]
categories: [Math]
---
**定理(拉格朗日插值公式)**:对于区间$[a,b]$上的某函数$f(x)$,若已知其在点$x_0,\dots,x_n$处的$n+1$个值$f(x_0),\dots,f(x_n)$,设

$$l_k(x)=\frac{(x-x_0)\cdots(x-x_{k-1})(x-x_{k+1})\cdots(x-x_n)}{(x_k-x_0)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)},k=0,\dots,n$$
则多项式
$$L(x)=\sum^n_{k=0}f(x_k)l_k(x)$$
满足条件,其称为拉格朗日插值多项式  
特别地,若令$\omega(x)=(x-x_0)\cdots(x-x_n)$,则该公式可紧凑地写为
$$L(x)=\sum^n_{k=0}\frac{\omega(x)}{\omega'(x_k)(x-x_k)}\cdot f(x_k)$$

证:  
我们已知$n+1$个点,所以我们不妨设用一个$n$次函数进行拟合,即设$\displaystyle f(x)=\sum\limits^n_{i=0}a_ix^i$满足题设  
分别带入这$n+1$个点,得到以$a_0,\dots,a_n$为未知数的线性方程组:

$$
\mathbf{B}\begin{bmatrix}
    a_0\\\\a_1\\\\a_2\\\\\vdots\\\\ a_n
\end{bmatrix}=
\begin{bmatrix}
    1&x_0^1&x_0^2&\cdots&x_0^n\\\\
    1&x_1^1&x_1^2&\cdots&x_1^n\\\\
    1&x_2^1&x_2^2&\cdots&x_2^n\\\\
    \vdots&\vdots&\vdots&&\vdots\\\\
    1&x_n^1&x_n^2&\cdots&x_n^n
\end{bmatrix}
\begin{bmatrix}
    a_0\\\\a_1\\\\a_2\\\\\vdots\\\\a_n
\end{bmatrix}
=
\begin{bmatrix}
    f(x_0)\\\\f(x_1)\\\\f(x_2)\\\\\vdots\\\\f(x_n)
\end{bmatrix}
$$

其解为:

$$
a_{i}=\frac{|\mathbf{B}_{i}|}{|\mathbf{B}|}=\frac
{\begin{vmatrix}
    1&x_0^1&\cdots&x_0^{i-1}&f(x_0)&x_0^{i+1}&\cdots&x_0^n\\\\
    1&x_1^1&\cdots&x_1^{i-1}&f(x_1)&x_1^{i+1}&\cdots&x_1^n\\\\
    \vdots&\vdots&&\vdots&\vdots&\vdots&&\vdots\\\\
    1&x_n^1&\cdots&x_n^{i-1}&f(x_n)&x_n^{i+1}&\cdots&x_n^n
\end{vmatrix}}
{\begin{vmatrix}
    1&x_0^1&x_0^2&\cdots&x_0^n\\\\
    1&x_1^1&x_1^2&\cdots&x_1^n\\\\
    \vdots&\vdots&\vdots&&\vdots\\\\
    1&x_n^1&x_n^2&\cdots&x_n^n
\end{vmatrix}}
$$

我们考虑将$|\mathbf{B}_i|$沿第$i+1$列展开

{% raw %}
$$
f(x)=\frac{1}{|\mathbf{B}|}\sum^n_{i=0}\sum^n_{j=0}(-1)^{i+j}f(x_j)x^i|\mathbf{B}_{ij}|
=\frac{1}{|\mathbf{B}|}\sum^n_{i=0}\sum^n_{j=0}(-1)^{i+j}f(x_j)x^i
\begin{vmatrix}
    1&x_0^1&\cdots&x_0^{i-1}&x_0^{i+1}&\cdots&x_0^n\\\\
    \vdots&\vdots&&\vdots&\vdots&&\vdots\\\\
    1&x_{j-1}^1&\cdots&x_{j-1}^{i-1}&x_{j-1}^{i+1}&\cdots&x_{j-1}^n\\\\
    1&x_{j+1}^1&\cdots&x_{j+1}^{i-1}&x_{j+1}^{i+1}&\cdots&x_{j+1}^n\\\\
    \vdots&\vdots&&\vdots&\vdots&&\vdots\\\\
    1&x_n^1&\cdots&x_n^{i-1}&x_n^{i+1}&\cdots&x_n^n
\end{vmatrix}
$$
{% endraw %}

我们拆开,先对$i$计算,再把$(-x)^i|\mathbf{B}_{ij}|$单独拆进去:

{% raw %}
$$
\begin{aligned}
f(x)=\frac{1}{|\mathbf{B}|}\sum^n_{j=0}(-1)^jf(x_j)\left(\sum^n_{i=0}(-x)^i|\mathbf{B}_{ij}|\right)\\\\
\sum^n_{i=0}(-x)^i|\mathbf{B}_{ij}|=|\mathbf{C_j}|
=\begin{vmatrix}
    1&(-x)^1&(-x)^2&(-x)^3&\cdots&(-x)^n\\\\
    1&x_1^1&x_1^2&x_1^3&\cdots&x_1^n\\\\
    \vdots&\vdots&\vdots&\vdots&&\vdots\\\\
    1&x_{j-1}^1&x_{j-1}^2&x_{j-1}^3&\cdots&x_{j-1}^n\\\\
    1&x_{j+1}^1&x_{j+1}^2&x_{j+1}^3&\cdots&x_{j+1}^n\\\\
    \vdots&\vdots&\vdots&\vdots&&\vdots\\\\
    1&x_n^1&x_n^2&x_n^3&\cdots&x_n^n
\end{vmatrix}
\end{aligned}
$$
{% endraw %}

故原式化为

$$f(x)=\frac{1}{|\mathbf{B}|}\sum^n_{j=0}(-1)^jf(x_j)\mathbf{C}_j$$

其中,$\mathbf{B};\mathbf{C}_j$是我们熟知的Vandermonde行列式  
求比之后化简,即可得到原式